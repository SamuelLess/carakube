import { create } from "zustand";
import type { VulnerabilityStateInfo } from "@/lib/api";

interface VulnerabilityStatesStore {
  states: Record<string, VulnerabilityStateInfo>;
  setStates: (states: Record<string, VulnerabilityStateInfo>) => void;
  setState: (vulnId: string, state: VulnerabilityStateInfo) => void;
  getState: (vulnId: string) => VulnerabilityStateInfo;
}

export const useVulnerabilityStatesStore = create<VulnerabilityStatesStore>((set, get) => ({
  states: {},
  setStates: (states) => set({ states }),
  setState: (vulnId, state) =>
    set((prev) => ({
      states: { ...prev.states, [vulnId]: state },
    })),
  getState: (vulnId) => {
    const state = get().states[vulnId];
    return (
      state || {
        state: "untouched",
        pr_url: null,
        updated_at: null,
      }
    );
  },
}));
